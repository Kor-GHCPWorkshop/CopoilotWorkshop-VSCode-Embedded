---
description: "임베디드 시스템 코드의 보안 취약점을 점검하고 개선 방안을 제안합니다."
---

# Embedded Security Check Prompt

아래 STM32F1 임베디드 코드를 분석하여 보안 취약점, 잠재적 위험 요소, 안전하지 않은 패턴을 찾아 설명하고, 각 항목에 대해 구체적인 개선 방안을 제안하세요.

## 임베디드 보안 점검 항목

### 🔒 메모리 보안
- 버퍼 오버플로우/언더플로우 취약점
- 스택 오버플로우 위험성
- 동적 메모리 할당 오용 (임베디드에서 금지)
- 초기화되지 않은 변수 사용
- 메모리 누수 (포인터 관리 미흡)

### ⚡ 하드웨어 보안
- 인터럽트 핸들러의 재진입 문제
- 임계 영역 보호 미흡 (__disable_irq(), __enable_irq())
- 타이밍 공격에 취약한 코드
- 하드웨어 레지스터 직접 접근 시 검증 부족
- DMA 버퍼 경계 검사 미흡

### 🛡️ 입력 검증 및 데이터 무결성
- GPIO 입력값 검증 부족
- UART/SPI/I2C 통신 데이터 검증 미흡
- 매개변수 NULL 포인터 검사 누락
- 배열 인덱스 경계 검사 부족
- 센서 데이터 범위 검증 미흡

### 🔐 인증 및 접근 제어
- 디버그 포트 보안 설정 미흡
- 펌웨어 서명 검증 누락
- 부트로더 보안 취약점
- 하드코딩된 키/비밀번호
- 권한 상승 취약점

### 📡 통신 보안
- 암호화되지 않은 통신 채널
- 취약한 암호화 알고리즘 사용
- 메시지 무결성 검증 부족
- 재전송 공격 대응 미흡
- 키 관리 취약점

### ⚠️ 오류 처리 및 로깅
- 민감 정보 로그 출력
- 오류 정보 노출
- 예외 처리 누락
- 디버그 정보 운영 환경 유지
- 시스템 상태 정보 노출

## 출력 형식
1. **보안 위험도 평가** (높음/중간/낮음)
2. **발견된 취약점 요약**
3. **각 취약점별 상세 분석**
   - 코드 위치 및 문제점
   - 잠재적 공격 시나리오
   - 비즈니스 영향도
4. **개선 방안 및 예시 코드**
5. **추가 보안 권장사항**
- [ ] 모든 함수에 입력 매개변수 검증 코드 존재
- [ ] 인터럽트 안전성 확보 (재진입 방지)
- [ ] 스택 사용량 모니터링 및 제한
- [ ] 하드웨어 리소스 접근 권한 제어
- [ ] 펌웨어 무결성 검증 메커니즘
- [ ] 안전한 부팅 프로세스 구현
- [ ] 디버그 인터페이스 보안 설정
- [ ] 민감 데이터 메모리 지우기 (보안 삭제)

모든 답변은 한국어로 작성하세요.